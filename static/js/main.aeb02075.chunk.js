(this["webpackJsonpvis-age"]=this["webpackJsonpvis-age"]||[]).push([[0],{144:function(e,t,n){e.exports=n(198)},149:function(e,t,n){},170:function(e,t,n){},195:function(e,t,n){},196:function(e,t,n){},198:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(13),i=n.n(o),c=(n(149),n(34)),l=n.n(c),s=n(3),u=n(25),d=n(50),f=n.n(d),v=n(4),m=n(74),p=n(33),g=window.devicePixelRatio||1,h=function(e,t){return{type:"SET_FILTER_VALUE",name:e,value:t}},y=n(8),b=n(203),E=n(1),O=(n(170),{setFilterValue:h}),x=Object(u.b)((function(e){return{filterValues:e.expressionDataset.filterValues,filterValueVocabulary:e.expressionDataset.filterValueVocabulary}}),O),w={start_age:"Start age",end_age:"End age",sex:"Sex",tissue:"Tissue",subtissue:"Subtissue",cell_ontology_class:"Cell type"};var j=x((function(e){var t=e.filterValues,n=e.filterValueVocabulary,a=e.setFilterValue;return r.a.createElement("div",{className:"filter-panel"},r.a.createElement(b.a,{className:"filter-element homolog-filter ".concat(E.a.MINIMAL),checked:null!=t.get("uniprot_daphnia"),onChange:function(e){return a("uniprot_daphnia",e.currentTarget.checked?"~":void 0)}},"has Daphnia homolog"),["start_age","end_age","sex","tissue","subtissue","cell_ontology_class"].map((function(e){var o;return r.a.createElement("div",{key:e,className:"filter-element"},r.a.createElement("div",{className:"filter-element-label"},w[e]),r.a.createElement(b.c,{className:"".concat(E.a.MINIMAL),selectedValue:t.get(e),onChange:function(t){return a(e,t.currentTarget.value)}},Object(y.a)((null===(o=n.get(e))||void 0===o?void 0:o.entries())||[]).map((function(e){return r.a.createElement(b.b,{key:e[0],value:e[0]},""!==e[0]?e[0]:"<none>",r.a.createElement("span",{className:"count"},e[1]))}))))})))})),_=n(41);function N(e){var t=e.children,n=e.canvasContainerRef,o=Object(p.c)(),i=o.mouse,c=o.size,l=c.width,u=c.height,d=o.camera,f=o.invalidate,m=Object(a.useMemo)((function(){return[{value:0},{value:performance.now()},{value:performance.now()}]}),[]),g=Object(s.a)(m,3),h=g[0],y=g[1],b=g[2],E=Object(a.useRef)(),O=Object(a.useRef)(),x=Object(a.useMemo)((function(){return{x:0,y:0,k:.25}}),[]);var w=Object(_.a)({onDrag:function(e){var t=e.event,n=e.last,a=e.down,r=Object(s.a)(e.delta,2),o=r[0],i=r[1];a&&(x.x-=o/x.k,x.y+=i/x.k,f()),n||null===t||void 0===t||t.preventDefault()},onWheel:function(e){var t=e.event,n=e.last,a=Object(s.a)(e.delta,2),r=a[0],o=a[1];if(0!==r||0!==o){var c=[.5*i.x*l/d.zoom+d.position.x,.5*i.y*u/d.zoom+d.position.y],v=Object(s.a)(c,2),m=v[0],p=v[1],g=1-.002*o;x.x+=(m-x.x)*-(1-g),x.y+=(p-x.y)*-(1-g),x.k*=g,f()}n||null===t||void 0===t||t.preventDefault()},onPinch:function(e){var t,n,a=e.event,r=e.first,o=e.last,i=e.down,c=Object(s.a)(e.da,2),v=c[0],m=(c[1],Object(s.a)(e.previous,2)),p=m[0],g=(m[1],e.origin),h=e.memo;if(i&&!r){var y=v/p;x.x+=(h[0]-x.x)*-(1-y),x.y+=(h[1]-x.y)*-(1-y),x.k*=y,f()}return o||null===a||void 0===a||a.preventDefault(),r?(t=(null===g||void 0===g?void 0:g[0])||0,n=(null===g||void 0===g?void 0:g[1])||0,[(t-.5*l)/d.zoom+d.position.x,(u-n-.5*u)/d.zoom+d.position.y]):h}},{domTarget:n,event:{passive:!1}});return Object(a.useEffect)((function(){w()}),[w]),Object(p.b)((function(){var e=performance.now();y.value=e,h.value++,e>b.value+1e3&&(b.value=e,h.value=0),d.position.x=x.x,d.position.y=x.y,d.zoom=x.k,d.updateProjectionMatrix()})),r.a.createElement("scene",{ref:E},r.a.createElement("ambientLight",{intensity:.5}),r.a.createElement("directionalLight",{intensity:.6,position:[0,0,1e3],rotation:new v.Euler(0,0,0),castShadow:!0,ref:O}),t)}n(195);var M=n(7),A=n(31),D=n(85),S={raw:[],filteredGeneExpression:new Map,filterValues:new Map,filterValueVocabulary:new Map,filterDimensionNames:[],customFilterFunctions:new Map,filtered:[],raw2filtered:new Map},T=function(e){return e.filterDimensionNames.forEach((function(t){var n,a=null===(n=e.filterDimensions)||void 0===n?void 0:n.get(t);if(a){var r=a.group().reduceCount().all().slice().sort((function(e,t){return e.key.localeCompare(t.key,"en",{numeric:!0})}));e.filterValueVocabulary.set(t,new Map(r.map((function(e){return[e.key,e.value]}))))}})),e},F=function(e){if(!e.crossfilter||!e.filterDimensions)return e;var t=!0,n=!1,a=void 0;try{for(var r,o=e.filterDimensions.entries()[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value,c=Object(s.a)(i,2),l=c[0],u=c[1];u.filterAll();var d=e.filterValues.get(l);if(null!=d){var f=e.customFilterFunctions.get(l);f?u.filterFunction(f(d)):u.filter(d)}}}catch(p){n=!0,a=p}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}e.filtered=e.crossfilter.allFiltered(),e.raw2filtered.clear(),e.filtered.forEach((function(t,n){return e.raw2filtered.set(t.__id||-1,n)})),e.filteredGeneExpression=new Map;for(var v=0;v<e.filtered.length;v++){var m=e.filtered[v];m.gene&&e.filteredGeneExpression.set(m.gene,m)}return e=T(e)},C=n(43),P=function(e,t){var n=[],a=[],r=new Map;e.forEach((function(e){return function(e){var t=Object(M.a)({},e,{location:0,x:1e3*(Math.random()-.5),y:1e3*(Math.random()-.5),vx:0,vy:0});if("molecule"===e.type&&e.cellularLocation){var a=e.cellularLocation;["extracellular region","external side of plasma membrane","cell junction"].some((function(e){return null===a||void 0===a?void 0:a.includes(e)}))?t.location=5:["cell outer membrane","cell wall","cell membrane","cytoplasmic side of plasma membrane","plasma membrane"].some((function(e){return null===a||void 0===a?void 0:a.includes(e)}))?t.location=4:["mitochondrial"].some((function(e){return null===a||void 0===a?void 0:a.includes(e)}))?t.location=3:["cytosol","host cell cytosol"].some((function(e){return null===a||void 0===a?void 0:a.includes(e)}))?t.location=0:["golgi"].some((function(e){return null===a||void 0===a?void 0:a.includes(e)}))?t.location=-3:["endoplasmic reticulum"].some((function(e){return null===a||void 0===a?void 0:a.includes(e)}))?t.location=-4:["nuclear envelope","nucleoplasm","nucleus","nucleolus","nuclear","chromosome","chromosome, centromeric region"].some((function(e){return null===a||void 0===a?void 0:a.includes(e)}))&&(t.location=-5)}n.push(t)}(e)})),t.forEach((function(e){return function(e){var t=Object(M.a)({},e),n=r.get(e.source);n||(n=[],r.set(e.source,n)),n.push(t);var o=r.get(e.target);o||(o=[],r.set(e.target,o)),o.push(t),a.push(t)}(Object(M.a)({},e,{sourcePos:[0,0],targetPos:[0,0]}))}));for(var o=function(e){var t=n[e];if("reaction"===t.type||"control"===t.type||"template_reaction"===t.type){var a=r.get(t.__id);if(a&&a.length>0){var o=a.map((function(e){return n[e.source===t.__id?e.target:e.source].location})).reduce((function(e,t){return e+t}),0)/a.length;t.location=o}}},i=0;i<n.length;i++)o(i);var c=Object(C.c)(n),l=JSON.parse(JSON.stringify(Array.from(r).map((function(e){return e[1]}))));c.force("charge",Object(C.b)().strength(-30)).force("link",Object(C.a)(l.reduce((function(e,t){return[].concat(Object(y.a)(e),Object(y.a)(t))}),[])).distance((function(e){return Math.max(250*Math.abs(e.target.location-e.source.location),10)}))).force("center",k(0,0,(function(e){}),(function(e){return null!=e.location?250*e.location:void 0}))),c.stop();var s=c.nodes(),u=[];return u.length===s.length?c.nodes().forEach((function(e,t){e.x=u[t].x,e.y=u[t].y})):(c.tick(50),u=s.map((function(e){return{x:e.x,y:e.y}}))),c.nodes().forEach((function(e,t){n[t].x=e.x,n[t].y=e.y,n[t].minX=e.x,n[t].maxX=e.x,n[t].minY=e.y,n[t].maxY=e.y})),a.forEach((function(e){e.sourcePos=[n[e.source].x,n[e.source].y],e.targetPos=[n[e.target].x,n[e.target].y]})),{nodes:n,edges:a,edgeMap:r}},V=function(e){var t={nodes:JSON.parse(JSON.stringify(e.nodes)),edges:[],edgeMap:new Map};return t.nodes.forEach((function(e){e.vx=0,e.vy=0,e.minX=e.x,e.maxX=e.x,e.minY=e.y,e.maxY=e.y})),e.edges.forEach((function(e){var n={source:e[0],target:e[1],relation:e[2],sourcePos:[0,0],targetPos:[0,0]};n.sourcePos=[t.nodes[n.source].x,t.nodes[n.source].y],n.targetPos=[t.nodes[n.target].x,t.nodes[n.target].y];var a=t.edgeMap.get(n.source);a||(a=[],t.edgeMap.set(n.source,a)),a.push(n);var r=t.edgeMap.get(n.target);r||(r=[],t.edgeMap.set(n.target,r)),r.push(n)})),t},k=function(e,t,n,a){var r,o,i,c,l=function(e){return function(){return e}},s=function(e){return 0===e.location?.2:5};function u(n){var a,l,s=r.length,u=0,d=0;for(a=0;a<s;++a)u+=(l=r[a]).x,d+=l.y;for(u=u/s-e,d=d/s-t,a=0;a<s;++a)l=r[a];for(var f=0,v=r.length;f<v;++f)l=r[f],null!=i[f]&&l.vx&&(l.vx+=(i[f]-l.x)*o[f]*n),null!=c[f]&&l.vy&&(l.vy+=(c[f]-l.y)*o[f]*n)}function d(){if(r){var e,t=r.length;for(o=new Array(t),i=new Array(t),c=new Array(t),e=0;e<t;++e)i[e]=n(r[e],e,r),c[e]=a(r[e],e,r),o[e]=+s(r[e])}}return u.initialize=function(e){r=e,d()},u.strength=function(e){return arguments.length?(s="function"===typeof e?e:l(+e),d(),u):s},u.x=function(e){return arguments.length?(n="function"===typeof e?e:l(+e),d(),u):n},u.y=function(e){return arguments.length?(a="function"===typeof e?e:l(+e),d(),u):a},u},I={raw:{nodes:[],edges:[]},graph:{nodes:[],edges:[],edgeMap:new Map},geneAnnotations:{genes:new Map}},L=function(e){return e.graph=P(e.raw.nodes.map((function(e){return e})),e.raw.edges.map((function(e){return{source:e[0],target:e[1],relation:e[2]}}))),e},R={active:!1,x:0,y:0,content:r.a.createElement(r.a.Fragment,null)},z={selectedNodes:[],selectedEdges:[]},U=Object(A.b)({expressionDataset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_DATASET":e.raw=t.dataset;for(var n=0;n<e.raw.length;n++){var a=e.raw[n];a.__id=n}return Object(M.a)({},e);case"SET_FILTER_DIMENSIONS":var r=t;return e.crossfilter=Object(D.a)(e.raw),e.filterDimensions=new Map,e.filterDimensionNames=r.dimensions,e.filterDimensionNames.forEach((function(t){e.crossfilter&&e.filterDimensions&&e.filterDimensions.set(t,e.crossfilter.dimension((function(e){return e[t]||""})))})),e.filterValues=new Map,(e=T(e)).filterDimensionNames.forEach((function(t){var n;e.filterValues.set(t,(null===(n=e.filterValueVocabulary.get(t))||void 0===n?void 0:n.entries().next().value[0])||"")})),e=F(e),Object(M.a)({},e);case"ADD_CUSTOM_FILTER_DIMENSION":var o=t;return e.filterDimensions&&e.crossfilter?(e.filterDimensions.set(o.name,e.crossfilter.dimension(o.selector)),o.filterFn&&e.customFilterFunctions.set(o.name,o.filterFn),e=F(e),Object(M.a)({},e)):(console.error("Trying to add a custom filter dimension before SET_FILTER_DIMENSIONS was called"),e);case"SET_FILTER_VALUE":var i=t;return e.filterValues.set(i.name,i.value),e.filterValues=new Map(e.filterValues),e=F(e),Object(M.a)({},e);default:return e}},pathways:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_PATHWAYS":var n=t;return n.pathways.dehydrated?e.graph=V(n.pathways):(e.raw=n.pathways,e=L(e)),Object(M.a)({},e);case"UPDATE_GENE_ANNOTATIONS":var a=t;return e.geneAnnotations={genes:new Map},a.geneAnnotations.forEach((function(t){return e.geneAnnotations.genes.set(t.name,t)})),Object(M.a)({},e);case"UPDATE_FILTER":return Object(M.a)({},e);default:return e}},tooltip:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_TOOLTIP":return e.x=t.x,e.y=t.y,e.content=t.content,e.active=!0,Object(M.a)({},e);case"HIDE_TOOLTIP":return e.active=!1,Object(M.a)({},e);default:return e}},selection:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_SELECTION":return e.selectedNodes=t.selectedNodes,e.selectedEdges=t.selectedEdges,Object(M.a)({},e);default:return e}}}),G=Object(A.c)(U),B=n(19),Y=n(22),J=n(20),W=n(21),X=function(e){function t(){var e;return Object(B.a)(this,t),(e=Object(Y.a)(this,Object(J.a)(t).call(this,{vertexShader:"\n        // attribute vec2 uv;\n        varying vec2 texcoord;\n        attribute vec4 color;\n        varying vec4 vColor;\n\n        void main() {\n            vec4 mvPosition = modelViewMatrix * vec4( position.xyz, 1.0 );\n            gl_Position = projectionMatrix * mvPosition;\n            texcoord = uv;\n            vColor = color;\n        }\n      ",fragmentShader:"\n        varying vec2 texcoord;\n        varying vec4 vColor;\n        void main() {\n          gl_FragColor = vColor;\n          gl_FragColor.w *= (1.0 - pow(texcoord.x, 4.0));\n          // gl_FragColor.w *= 0.2;\n        }\n      ",blendSrc:v.SrcAlphaFactor,blendDst:v.OneMinusSrcAlphaFactor,blending:v.CustomBlending,transparent:!0}))).uniforms={map:{value:null}},e}return Object(W.a)(t,e),t}(v.ShaderMaterial);var H=function(e){var t=e.edges,n=e.color,o=Object(a.useMemo)((function(){var e=[],a=[],r=[];return t.forEach((function(t){return o=t,e.push(o.sourcePos[0],o.sourcePos[1],0,o.targetPos[0],o.targetPos[1],0),a.push(0,0,1,1),r.push.apply(r,Object(y.a)(n)),void r.push.apply(r,Object(y.a)(n));var o})),[new v.BufferAttribute(new Float32Array(e),3),new v.BufferAttribute(new Float32Array(a),2),new v.BufferAttribute(new Float32Array(r),4)]}),[t]),i=Object(s.a)(o,3),c=i[0],l=i[1],u=i[2],d=Object(a.useMemo)((function(){return[new X]}),[]),f=Object(s.a)(d,1)[0];return r.a.createElement("lineSegments",{frustumCulled:!1,material:f},r.a.createElement("bufferGeometry",{attach:"geometry",attributes:{position:c,uv:l,color:u}}))},q=n(82),$=function(e,t){return function(n){function a(e){var t;return Object(B.a)(this,a),(t=Object(Y.a)(this,Object(J.a)(a).call(this,e))).subscription=function(){},t._mounted=!1,t.state={selection:{selectedNodes:[],selectedEdges:[]}},t}return Object(W.a)(a,n),Object(q.a)(a,[{key:"handleStoreUpdate",value:function(){this._mounted&&this.setState({selection:Object(M.a)({},G.getState().selection)})}},{key:"componentDidMount",value:function(){this._mounted=!0,this.subscription=G.subscribe(this.handleStoreUpdate.bind(this)),this.handleStoreUpdate()}},{key:"componentWillUnmount",value:function(){this._mounted=!1,this.subscription()}},{key:"render",value:function(){var n=t(this.state.selection,this.props);return r.a.createElement(e,n)}}]),a}(r.a.Component)},K=function(e){function t(e){var n;return Object(B.a)(this,t),(n=Object(Y.a)(this,Object(J.a)(t).call(this,{vertexShader:"\n        attribute float size;\n        attribute vec4 color;\n        varying vec4 vColor;\n\n        void main() {\n            vec4 mvPosition = modelViewMatrix * vec4( position.xyz, 1.0 );\n            gl_PointSize = 5.0 * size;\n            gl_Position = projectionMatrix * mvPosition;\n            vColor = color;\n            // if(size == 0.0)\n            //   color.w = 0.0;\n        }\n      ",fragmentShader:"\n        uniform sampler2D pointTexture;\n        varying vec4 vColor;\n        void main() {\n          gl_FragColor = vColor * texture2D(pointTexture, gl_PointCoord);\n          // gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n          // gl_FragColor.w *= 0.4;\n        }\n      ",blending:v.NormalBlending,transparent:!0}))).uniforms={pointTexture:{value:e.pointTexture}},n}return Object(W.a)(t,e),t}(v.ShaderMaterial);var Q=function(e){var t=e.nodes,n=e.sizes,o=e.colors,i=Object(a.useMemo)((function(){var e=[];return t.forEach((function(t){return n=t,void e.push(n.x,n.y,0);var n})),[new v.BufferAttribute(new Float32Array(e),3)]}),[t]),c=Object(s.a)(i,1)[0],l=Object(a.useMemo)((function(){return[new v.BufferAttribute(new Float32Array(n),1),new v.BufferAttribute(new Float32Array(o),4)]}),[n,o]),u=Object(s.a)(l,2),d=u[0],f=u[1],m=Object(a.useMemo)((function(){var e=new v.TextureLoader;return[new K({pointTexture:e.load("./textures/circle.png")})]}),[]),p=Object(s.a)(m,1)[0];return t.length<1?r.a.createElement(r.a.Fragment,null):r.a.createElement("points",{frustumCulled:!1,material:p},r.a.createElement("bufferGeometry",{attach:"geometry",attributes:{position:c,size:d,color:f}}))},Z=function(e){var t=e.nodes,n=e.edges,o=[0,0,0,.05],i=[251/255,101/255,66/255,.4],c=[55/255,94/255,151/255,.4],l=Object(a.useState)(G.getState().expressionDataset.filteredGeneExpression),u=Object(s.a)(l,2),d=u[0],f=u[1],v=function(){f(G.getState().expressionDataset.filteredGeneExpression)};function m(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],a=[],r=0;r<e.length;r++){var l=e[r],s=o,u=1;if("molecule"===l.type){var f,v,m=null===(f=l.entityReference)||void 0===f?void 0:null===(v=f.gene)||void 0===v?void 0:v.name;if(m){var p=d.get(m);if(null!=p){var g=p.fold_change_log2||0;u=2*Math.sqrt(Math.abs(g)),s=g>0?i:c}}}t&&((s=s.slice())[3]=1),n.push.apply(n,Object(y.a)(s)),a.push(u)}return[n,a]}Object(a.useEffect)((function(){var e=G.subscribe((function(){v()}));return v(),e}),[]);var p=Object(a.useMemo)((function(){return m(t)}),[t,d]),g=Object(s.a)(p,2),h=g[0],b=g[1],E=$(Q,(function(e,t){var n=m(e.selectedNodes,!0),a=Object(s.a)(n,2),r=a[0],o=a[1];return Object(M.a)({},t,{nodes:e.selectedNodes,colors:r,sizes:o})})),O=$(H,(function(e,t){return Object(M.a)({},t,{edges:e.selectedEdges})}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(H,{edges:n,color:[0,0,0,.2]}),r.a.createElement(O,{edges:[],color:[130/255,179/255,54/255,1]}),r.a.createElement(Q,{nodes:t,sizes:b,colors:h}),r.a.createElement(E,{nodes:[],sizes:[],colors:[]}))};n(196);var ee=function(e){var t=e.active,n=e.x,a=e.y,o=e.content;return r.a.createElement("div",{className:"tooltip",style:{left:n,top:a,display:t?"block":"none"}},o)},te=n(83),ne=n.n(te),ae=n(84),re=n.n(ae),oe={updateSelection:function(e,t){return{type:"UPDATE_SELECTION",selectedNodes:e,selectedEdges:t}}};var ie=Object(u.b)((function(e){return{expressionDataset:e.expressionDataset,filteredGeneExpression:e.expressionDataset.filteredGeneExpression,graph:e.pathways.graph,geneAnnotations:e.pathways.geneAnnotations}}),oe)((function(e){var t=e.nodes,n=e.graph,o=e.geneAnnotations,i=e.canvasContainerRef,c=e.canvasCtx,l=e.expressionDataset,u=e.filteredGeneExpression,d=e.updateSelection,f=Object(a.useMemo)((function(){for(var e=new Map,n=new ne.a,a=[],r=0;r<t.length;r++){var o=t[r],i=!1,c=-1;if("molecule"===o.type){var l,s,d=null===(l=o.entityReference)||void 0===l?void 0:null===(s=l.gene)||void 0===s?void 0:s.name;if(d){var f=u.get(d);null!=f&&(i=!0,c=f.__id||-1)}}i&&a.push(t[r]),e.set(o.__id,c)}return n.load(a),[e,n]}),[u,t]),v=Object(s.a)(f,2),m=v[0],p=v[1],g=Object(a.useState)(-1),h=Object(s.a)(g,2),b=h[0],E=h[1],O=Object(a.useState)({active:!1,x:0,y:0,content:r.a.createElement(r.a.Fragment,null)}),x=Object(s.a)(O,2),w=x[0],j=x[1];function N(e,t){var a,s;if(c){var u=e-((null===(a=i.current)||void 0===a?void 0:a.offsetLeft)||0),f=t-((null===(s=i.current)||void 0===s?void 0:s.offsetTop)||0),v=c.size,g=v.width,h=v.height,O=c.camera,x=(u-g/2)/O.zoom+O.position.x,w=(h-f-h/2)/O.zoom+O.position.y,_=re()(p,x,w,1);if(_.length>0){var N=_[0];if(N.__id!==b){var M,A,D,S,T,F,C,P;E(N.__id);var V=m.get(N.__id),k=V&&V>=0?l.raw[V]:void 0,I=Array.from(new Set((n.edgeMap.get(N.__id)||[]).map((function(e){return{node:n.nodes[e.source===N.__id?e.target:e.source],relation:e.relation}})))),L=I.map((function(e){return n.edgeMap.get(e.node.__id)||[]})).reduce((function(e,t){return[].concat(Object(y.a)(e),Object(y.a)(t))}),[]),R={};L.forEach((function(e){R[e.source]=n.nodes[e.source],R[e.target]=n.nodes[e.target]}));var z=null===(M=N.entityReference)||void 0===M?void 0:null===(A=M.gene)||void 0===A?void 0:A.name,U=void 0;z&&(U=o.genes.get(z)),d(Object.values(R),L);var G=function(e,t,n,a){var o=0,i=[];if(null==e)return i.push(r.a.createElement("div",{key:0},"\u2014")),i;for(;o<e.length&&o<n;)i.push(t(e[o],o)),o++;if(o<e.length){var c=r.a.createElement("div",{className:"list-truncation-notice",key:o+1},e.length-o," more..");a&&(c=a(c,o+1)),i.push(c)}return i};j({active:!0,x:((N.x||0)-O.position.x)*O.zoom+g/2,y:h/2-((N.y||0)-O.position.y)*O.zoom,content:r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"prop"},r.a.createElement("div",{className:"name"},"Name"),r.a.createElement("div",{className:"value"},z||N.name)),r.a.createElement("div",{className:"prop"},r.a.createElement("div",{className:"name"},"Location"),r.a.createElement("div",{className:"value"},N.cellularLocation)),r.a.createElement("div",{className:"prop"},r.a.createElement("div",{className:"name"},"log",r.a.createElement("sub",null,"2"),"(Fold-change)"),r.a.createElement("div",{className:"value",style:{color:((null===k||void 0===k?void 0:k.fold_change_log2)||0)>0?"#fb6542":"#375e97"}},null===k||void 0===k?void 0:null===(D=k.fold_change_log2)||void 0===D?void 0:D.toFixed(2))),r.a.createElement("div",{className:"prop"},r.a.createElement("div",{className:"name"},"xref"),r.a.createElement("div",{className:"value"},null===(S=N.entityReference)||void 0===S?void 0:null===(T=S.xref)||void 0===T?void 0:T.db,":",null===(F=N.entityReference)||void 0===F?void 0:null===(C=F.xref)||void 0===C?void 0:C.id)),r.a.createElement("div",{className:"prop"},r.a.createElement("div",{className:"name"},"GO terms"),r.a.createElement("div",{className:"value"},G(null===(P=U)||void 0===P?void 0:P.go_terms,(function(e,t){return r.a.createElement("div",{className:"go-term",key:t},e)}),2))),G(I,(function(e,t){return r.a.createElement("div",{className:"prop",key:t},r.a.createElement("div",{className:"name"},r.a.createElement("span",{className:"accent"},e.relation)," in"),r.a.createElement("div",{className:"value"},e.node.name))}),2,(function(e,t){return r.a.createElement("div",{className:"prop",key:t},r.a.createElement("div",{className:"name"}),r.a.createElement("div",{className:"value"},e))})))})}}}else console.warn("canvasCtx not set, ignoring tooltip events")}var M=Object(_.a)({onMove:function(e){var t=Object(s.a)(e.xy,2);N(t[0],t[1])},onTouchStart:function(e){var t=e.touches;N(t[0].pageX,t[0].pageY)}},{domTarget:i,event:{passive:!1}});return Object(a.useEffect)((function(){M()}),[M,c]),r.a.createElement(ee,w)})),ce={updateDataset:function(e){return{type:"UPDATE_DATASET",dataset:e}},setFilterDimensions:function(e){return{type:"SET_FILTER_DIMENSIONS",dimensions:e}},addCustomFilterDimension:function(e,t,n){return{type:"ADD_CUSTOM_FILTER_DIMENSION",name:e,selector:t,filterFn:n}},setFilterValue:h,updatePathways:function(e){return{type:"UPDATE_PATHWAYS",pathways:e}},updateGeneAnnotations:function(e){return{type:"UPDATE_GENE_ANNOTATIONS",geneAnnotations:e}}};var le=Object(u.b)((function(e){return{nodes:e.pathways.graph.nodes,edges:e.pathways.graph.edges}}),ce)((function(e){var t=e.updateDataset,n=e.setFilterDimensions,o=e.addCustomFilterDimension,i=e.setFilterValue,c=e.updatePathways,u=e.updateGeneAnnotations,d=e.nodes,h=(e.edges,Object(a.useState)(!0)),y=Object(s.a)(h,2),b=y[0],E=y[1];Object(a.useEffect)((function(){!function(){var e,a,r,s;l.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,l.a.awrap(new Promise((function(e,t){m.parse("./data/merged_augmented.csv",{delimiter:",",header:!0,download:!0,dynamicTyping:!0,skipEmptyLines:!0,complete:e,error:t})})));case 2:return e=d.sent,null===t||void 0===t||t(e.data),null===n||void 0===n||n(["start_age","end_age","sex","tissue","subtissue","cell_ontology_class"]),null===i||void 0===i||i("sex","male"),["tissue","subtissue","cell_ontology_class"].map((function(e){return null===i||void 0===i?void 0:i(e,"")})),a=["tissue","subtissue","cell_ontology_class","gene","uniprot_mouse","uniprot_daphnia"],null===o||void 0===o||o("text",(function(e){return a.map((function(t){return e[t]})).join("|").toLowerCase()}),(function(e){return function(t){return t.includes(e.toLowerCase())}})),null===o||void 0===o||o("uniprot_daphnia",(function(e){return e.uniprot_daphnia||""}),(function(e){return"~"===e?function(e){return null!=e&&""!==e}:function(t){return t===e}})),d.next=12,l.a.awrap(f.a.get("./data/pathways_preprocessed.json"));case 12:return r=d.sent,null===c||void 0===c||c(r.data),d.next=16,l.a.awrap(f.a.get("./data/gene_annotations.json"));case 16:s=d.sent,null===u||void 0===u||u(s.data),E(!1);case 19:case"end":return d.stop()}}))}()}),[]);var O=Object(a.useRef)(null),x=Object(a.useRef)(),w=Object(a.useMemo)((function(){return(null===d||void 0===d?void 0:d.filter((function(e){var t;return null===(t=e.entityReference)||void 0===t?void 0:t.gene})))||[]}),[d]);return r.a.createElement("div",{className:"App"},r.a.createElement(ie,{nodes:w,canvasContainerRef:O,canvasCtx:x.current}),r.a.createElement(j,null),r.a.createElement("div",{className:"main-canvas",ref:O},r.a.createElement(p.a,{camera:{fov:75,near:1,far:1e4,position:[0,0,1e3],rotation:new v.Euler(0,0,0)},orthographic:!0,pixelRatio:g,invalidateFrameloop:!0,gl2:!0,onCreated:function(e){x.current=e}},r.a.createElement(N,{canvasContainerRef:O},r.a.createElement(Z,{nodes:w,edges:[]})))),b&&r.a.createElement("div",{className:"loading"},r.a.createElement("div",{className:"lds-ripple"},r.a.createElement("div",null),r.a.createElement("div",null))))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(u.a,{store:G},r.a.createElement(le,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[144,1,2]]]);
//# sourceMappingURL=main.aeb02075.chunk.js.map